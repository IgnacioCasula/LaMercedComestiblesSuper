{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Nuevo Empleado</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{% static 'CSS/crear_empleado_styles.css' %}">
</head>
<body 
    data-inicio-url="{% url 'inicio' %}"
    data-add-icon-url="{% static 'iconos/add_circle.png' %}"
    data-remove-icon-url="{% static 'iconos/remove_circle.png' %}"
    data-api-areas-url="{% url 'api_areas' %}"
    data-api-crear-area-url="{% url 'api_crear_area' %}"
    data-api-crear-puesto-url="{% url 'api_crear_puesto' %}"
    data-api-registrar-empleado-url="{% url 'api_registrar_empleado' %}">

<div class="form-container">
    <h1>Añadir Nuevo Empleado</h1>

    <div class="section">
        <div class="personal-data-grid">
            <div class="photo-uploader" id="photo-uploader">
                <input type="file" id="photo-input" accept="image/*" style="display: none;">
                <button id="photo-button">Añadir Foto</button>
            </div>
            <div class="fields-grid">
                <div class="form-group"><label for="nombre">Nombre:</label><input type="text" id="nombre"></div>
                <div class="form-group"><label for="apellido">Apellido:</label><input type="text" id="apellido"></div>
                <div class="form-group"><label for="dni">DNI:</label><input type="text" id="dni"></div>
                <div class="form-group"><label for="telefono">Telefono:</label><input type="text" id="telefono"></div>
                <div class="form-group"><label for="email">Email:</label><input type="email" id="email"></div>
                <div class="form-group"><label for="cod_pais">Codigo Telefonico:</label><input type="text" id="cod_pais"></div>
                <div class="form-group"><label for="direccion">Direccion:</label><input type="text" id="direccion"></div>
                <div class="form-group"><label for="fecha_nacimiento">Fecha nacimiento:</label><input type="text" id="fecha_nacimiento" placeholder="DD/MM/AAAA"></div>
            </div>
        </div>
        <div class="form-actions-initial">
            <button id="btn-add-laboral" class="btn btn-secondary">Añadir datos laborales</button>
            <button class="btn btn-light">Predeterminado</button>
        </div>
    </div>

    <div id="laboral-data" class="laboral-data">
        <div class="section">
            <div class="area-puesto">
                <div class="form-group" style="flex-grow: 1;">
                    <label>Area:</label>
                    <button id="btn-area" class="selector-btn">Selecciona un área</button>
                </div>
                <div class="form-group" style="flex-grow: 1;">
                    <label>Puesto:</label>
                    <button id="btn-puesto" class="selector-btn" disabled>Selecciona un puesto</button>
                </div>
            </div>
        </div>
        
        <div class="section schedule-section">
            <div class="schedule-header">
                <h3>Horario Semanal Recurrente</h3>
            </div>
            <div class="color-palette-container">
                <span>Mismo horario para:</span>
                <div id="color-palette" class="color-palette"></div>
                <button id="add-color" class="add-btn">
                    <img src="{% static 'iconos/add_circle.png' %}" alt="Añadir color">
                </button>
            </div>
            <div id="schedule-container"></div>
            <div class="daily-schedule-container" id="daily-schedule-container"></div>
        </div>

        <div class="section permissions-section">
            <div class="permissions-header">
                <h3>Permisos y Herramientas</h3>
                <div class="mode-selector">
                    <span>Modo:</span>
                    <button id="permissions-mode-btn" class="btn btn-light-alt">Personalizado</button>
                </div>
            </div>
            <div id="permissions-list" class="permissions-list-grid">
                 {% if herramientas %}
                    {% for herramienta in herramientas %}
                    <div class="permission-card">
                        <div class="permission-main">
                            <label class="switch">
                                <input type="checkbox" id="perm-{{ herramienta.idherramienta }}" name="permisos" value="{{ herramienta.idherramienta }}">
                                <span class="slider"></span>
                            </label>
                            <label for="perm-{{ herramienta.idherramienta }}" class="permission-label">{{ herramienta.nombre }}</label>
                        </div>
                        <p class="permission-description">
                            {% if herramienta.url_nombre == 'caja:menu_caja' %}
                                Otorga acceso al menú de caja para realizar aperturas, cierres y registrar ventas.
                            {% elif herramienta.url_nombre == 'crear_empleado' %}
                                Permite al usuario acceder al formulario para registrar nuevos empleados en el sistema.
                            {% else %}
                                Descripción no disponible.
                            {% endif %}
                        </p>
                    </div>
                    {% endfor %}
                {% else %}
                    <p>No hay herramientas disponibles para asignar.</p>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="main-form-actions">
        <button id="btn-cancel" class="btn btn-danger">Cancelar</button>
        <button class="btn btn-success">Listo</button>
    </div>
</div>

<div id="modal-opciones" class="modal-overlay">
    <div class="modal-content">
        <h2 id="opciones-titulo"></h2>
        <div class="modal-options">
            <button id="btn-opcion-cargar" class="modal-btn">Cargar existente</button>
            <button id="btn-opcion-crear" class="modal-btn">Crear nuevo</button>
        </div>
        <div class="modal-actions">
            <button class="btn btn-light" onclick="cerrarModal('modal-opciones')">Volver</button>
        </div>
    </div>
</div>
<div id="modal-cargar" class="modal-overlay">
    <div class="modal-content">
        <h2 id="cargar-titulo"></h2>
        <input type="text" id="searchInput" placeholder="Buscar...">
        <ul id="resultsList"></ul>
        <div class="modal-actions">
            <button class="btn btn-light" id="btn-cargar-volver">Volver</button>
        </div>
    </div>
</div>
<div id="modal-crear" class="modal-overlay">
    <div class="modal-content">
        <h2 id="crear-titulo"></h2>
        <div class="form-group">
            <label for="new-item-name" id="crear-label"></label>
            <input type="text" id="new-item-name" class="form-control">
        </div>
        <div id="crear-error-msg" style="color: red; margin-top: 10px; text-align: center;"></div>
        <div class="modal-actions">
            <button class="btn btn-light" id="btn-crear-volver">Volver</button>
            <button class="btn btn-success" id="btn-crear-confirmar">Crear</button>
        </div>
    </div>
</div>

<script src="{% static 'JS/crear_empleado.js' %}"></script>
</body>
</html>