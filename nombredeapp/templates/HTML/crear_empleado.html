{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Nuevo Empleado</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{% static 'CSS/crear_empleado_styles.css' %}">
</head>
<body 
    data-inicio-url="{% url 'inicio' %}"
    data-add-icon-url="{% static 'iconos/add_circle.png' %}"
    data-remove-icon-url="{% static 'iconos/remove_circle.png' %}"
    data-api-areas-url="{% url 'api_areas' %}"
    data-api-crear-area-url="{% url 'api_crear_area' %}"
    data-api-crear-puesto-url="{% url 'api_crear_puesto' %}"
    data-api-registrar-empleado-url="{% url 'api_registrar_empleado' %}">

<div class="form-container">
    <h1>Añadir Nuevo Empleado</h1>

    <!-- SECCIÓN 1: DATOS PERSONALES -->
    <div class="section">
        <h2 class="section-title">📋 Datos Personales</h2>
        <div class="personal-data-grid">
            <div class="photo-uploader" id="photo-uploader">
                <input type="file" id="photo-input" accept="image/*" style="display: none;">
                <button type="button" id="photo-button">Añadir Foto</button>
            </div>
            <div class="fields-grid">
                <div class="form-group">
                    <label for="nombre">Nombre: <span class="required">*</span></label>
                    <input type="text" id="nombre" required>
                </div>
                <div class="form-group">
                    <label for="apellido">Apellido: <span class="required">*</span></label>
                    <input type="text" id="apellido" required>
                </div>
                <div class="form-group">
                    <label for="dni">DNI: <span class="required">*</span></label>
                    <input type="text" id="dni" required>
                </div>
                <div class="form-group">
                    <label for="email">Email: <span class="required">*</span></label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="telefono">Teléfono:</label>
                    <input type="text" id="telefono">
                </div>
                <div class="form-group">
                    <label for="cod_pais">Código Telefónico:</label>
                    <input type="text" id="cod_pais" value="+54">
                </div>
                <div class="form-group">
                    <label for="direccion">Dirección:</label>
                    <input type="text" id="direccion">
                </div>
                <div class="form-group">
                    <label for="fecha_nacimiento">Fecha de Nacimiento:</label>
                    <input type="text" id="fecha_nacimiento" placeholder="DD/MM/AAAA">
                </div>
            </div>
        </div>
        <div class="form-actions-initial">
            <button type="button" id="btn-add-laboral" class="btn btn-secondary">Añadir datos laborales</button>
            <button type="button" id="btn-cargar-datos" class="btn btn-light" style="display: none;">Cargar datos laborales</button>
        </div>
    </div>

    <!-- SECCIÓN 2: DATOS LABORALES -->
    <div id="laboral-data" class="laboral-data">
        <div class="section">
            <h2 class="section-title">💼 Datos Laborales</h2>
            <div class="area-puesto">
                <div class="form-group" style="flex-grow: 1;">
                    <label>Área: <span class="required">*</span></label>
                    <button type="button" id="btn-area" class="selector-btn">Selecciona un área</button>
                </div>
                <div class="form-group" style="flex-grow: 1;">
                    <label>Puesto: <span class="required">*</span></label>
                    <button type="button" id="btn-puesto" class="selector-btn" disabled>Selecciona un puesto</button>
                </div>
            </div>
        </div>
        
        <!-- SECCIÓN 3: HORARIO -->
        <div class="section schedule-section">
            <h2 class="section-title">🕐 Horario Semanal Recurrente</h2>
            <div class="color-palette-container">
                <span>Mismo horario para:</span>
                <div id="color-palette" class="color-palette"></div>
                <button type="button" id="add-color" class="add-btn">
                    <img src="{% static 'iconos/add_circle.png' %}" alt="Añadir color">
                </button>
            </div>
            <div id="schedule-container"></div>
            <div class="daily-schedule-container" id="daily-schedule-container"></div>
        </div>

        <!-- SECCIÓN 4: PERMISOS -->
        <div class="section permissions-section">
            <div class="permissions-header">
                <h2 class="section-title">🔒 Permisos del Sistema</h2>
                <button type="button" class="btn btn-light-alt" onclick="toggleAllPermisos()">
                    <i class="fas fa-check-double"></i> Marcar/Desmarcar Todos
                </button>
            </div>
            <p class="permissions-description">
                Selecciona los permisos que tendrá este empleado. Los permisos determinarán qué herramientas y funciones podrá utilizar en el sistema.
            </p>
            
            <div id="permissions-list" class="permissions-list-modern">
                <!-- Permiso: Caja -->
                <div class="permission-card-modern">
                    <div class="permission-header-modern">
                        <label class="switch">
                            <input type="checkbox" name="permisos" value="caja">
                            <span class="slider"></span>
                        </label>
                        <div class="permission-info">
                            <h4 class="permission-name">
                                <i class="fas fa-cash-register"></i> Caja
                            </h4>
                            <p class="permission-desc">
                                Permite abrir y cerrar cajas, registrar ventas y gestionar operaciones de punto de venta.
                            </p>
                        </div>
                    </div>
                    <div class="permission-badge">Operaciones</div>
                </div>

                <!-- Permiso: Gestión de Stock -->
                <div class="permission-card-modern">
                    <div class="permission-header-modern">
                        <label class="switch">
                            <input type="checkbox" name="permisos" value="stock">
                            <span class="slider"></span>
                        </label>
                        <div class="permission-info">
                            <h4 class="permission-name">
                                <i class="fas fa-boxes"></i> Gestión de Stock
                            </h4>
                            <p class="permission-desc">
                                Administrar inventario, registrar entradas y salidas de productos, y actualizar existencias.
                            </p>
                        </div>
                    </div>
                    <div class="permission-badge badge-inventory">Inventario</div>
                </div>
            </div>

            <div class="permissions-summary">
                <i class="fas fa-info-circle"></i>
                <span>Los permisos pueden ser modificados posteriormente desde la configuración de usuario.</span>
            </div>
        </div>
    </div>

    <!-- BOTONES FINALES -->
    <div class="main-form-actions">
        <button type="button" id="btn-cancel" class="btn btn-danger">
            <i class="fas fa-times"></i> Cancelar
        </button>
        <button type="button" class="btn btn-success">
            <i class="fas fa-check"></i> Listo
        </button>
    </div>
</div>

<!-- MODALES -->
<div id="modal-opciones" class="modal-overlay">
    <div class="modal-content">
        <h2 id="opciones-titulo"></h2>
        <div class="modal-options">
            <button type="button" id="btn-opcion-cargar" class="modal-btn">
                <i class="fas fa-folder-open"></i> Cargar existente
            </button>
            <button type="button" id="btn-opcion-crear" class="modal-btn">
                <i class="fas fa-plus-circle"></i> Crear nuevo
            </button>
        </div>
        <div class="modal-actions">
            <button type="button" class="btn btn-light" onclick="cerrarModal('modal-opciones')">Volver</button>
        </div>
    </div>
</div>

<div id="modal-cargar" class="modal-overlay">
    <div class="modal-content">
        <h2 id="cargar-titulo"></h2>
        <input type="text" id="searchInput" placeholder="Buscar...">
        <ul id="resultsList"></ul>
        <div class="modal-actions">
            <button type="button" class="btn btn-light" id="btn-cargar-volver">Volver</button>
        </div>
    </div>
</div>

<div id="modal-crear" class="modal-overlay">
    <div class="modal-content">
        <h2 id="crear-titulo"></h2>
        <div class="form-group">
            <label for="new-item-name" id="crear-label"></label>
            <input type="text" id="new-item-name" class="form-control">
        </div>
        <div id="crear-error-msg" style="color: red; margin-top: 10px; text-align: center;"></div>
        <div class="modal-actions">
            <button type="button" class="btn btn-light" id="btn-crear-volver">Volver</button>
            <button type="button" class="btn btn-success" id="btn-crear-confirmar">Crear</button>
        </div>
    </div>
</div>

<script src="{% static 'JS/crear_empleado.js' %}"></script>
</body>
</html>