{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesti칩n de Empleados</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{% static 'CSS/crear_empleado_styles.css' %}">
</head>
<body 
    data-inicio-url="{% url 'inicio' %}"
    data-add-icon-url="{% static 'iconos/add_circle.png' %}"
    data-remove-icon-url="{% static 'iconos/remove_circle.png' %}"
    data-api-areas-url="{% url 'api_areas' %}"
    data-api-puestos-por-area-url="/api/puestos/"
    data-api-registrar-empleado-url="{% url 'api_registrar_empleado' %}"
    data-api-buscar-empleados-url="{% url 'api_buscar_empleados' %}"
    data-api-asignar-rol-url="{% url 'api_asignar_nuevo_rol' %}">

<!-- 游 MODAL DE SELECCI칍N: CREAR NUEVO O ASIGNAR ROL -->
<div id="modal-tipo-operacion" class="modal-confirmacion-overlay show">
    <div class="modal-confirmacion-content">
        <div class="modal-confirmacion-header">
            <i class="fas fa-users-cog"></i>
            <h2>쯈u칠 deseas hacer?</h2>
        </div>
        <div class="modal-confirmacion-body">
            <p class="modal-confirmacion-pregunta">
                Selecciona una opci칩n para continuar:
            </p>
            <div class="tipo-operacion-btns">
                <button class="btn-tipo-operacion" id="btn-crear-nuevo">
                    <i class="fas fa-user-plus"></i>
                    <div>
                        <h3>Crear Nuevo Empleado</h3>
                        <p>Registrar un empleado completamente nuevo en el sistema</p>
                    </div>
                </button>
                <button class="btn-tipo-operacion" id="btn-asignar-rol">
                    <i class="fas fa-user-tag"></i>
                    <div>
                        <h3>Asignar Rol Adicional</h3>
                        <p>Agregar un nuevo 치rea o puesto a un empleado existente</p>
                    </div>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- 游 MODAL PARA BUSCAR EMPLEADO EXISTENTE -->
<div id="modal-buscar-empleado" class="modal-overlay">
    <div class="modal-content">
        <h2><i class="fas fa-search"></i> Buscar Empleado</h2>
        <input type="text" id="search-empleado-input" placeholder="Buscar por nombre, apellido o DNI...">
        <div id="empleados-encontrados" class="empleados-list"></div>
        <div class="modal-actions">
            <button type="button" class="btn btn-light" id="btn-cancelar-busqueda">Cancelar</button>
        </div>
    </div>
</div>

<div class="form-container" id="main-form-container" style="display: none;">
    <h1 id="titulo-principal">A침adir Nuevo Empleado</h1>
    
    <!-- 游 BANNER DE EMPLEADO SELECCIONADO (solo visible en modo asignar rol) -->
    <div id="empleado-seleccionado-banner" style="display: none;">
        <div class="empleado-banner">
            <div class="empleado-banner-foto">
                <img id="banner-foto" src="" alt="Foto">
            </div>
            <div class="empleado-banner-info">
                <h3 id="banner-nombre"></h3>
                <p id="banner-dni"></p>
                <p id="banner-email"></p>
            </div>
            <div class="empleado-banner-roles">
                <h4><i class="fas fa-briefcase"></i> Roles actuales:</h4>
                <div id="banner-roles-list"></div>
            </div>
        </div>
    </div>

    <!-- SECCI칍N 1: DATOS PERSONALES (solo visible en modo crear) -->
    <div class="section" id="seccion-datos-personales">
        <h2 class="section-title">游늶 Datos Personales</h2>
        <div class="personal-data-grid">
            <div class="photo-uploader" id="photo-uploader">
                <input type="file" id="photo-input" accept="image/*" style="display: none;">
                <button type="button" id="photo-button">A침adir Foto</button>
            </div>
            <div class="fields-grid">
                <div class="form-group">
                    <label for="nombre">Nombre: <span class="required">*</span></label>
                    <input type="text" id="nombre" required>
                </div>
                <div class="form-group">
                    <label for="apellido">Apellido: <span class="required">*</span></label>
                    <input type="text" id="apellido" required>
                </div>
                <div class="form-group">
                    <label for="dni">DNI: <span class="required">*</span></label>
                    <input type="text" id="dni" required>
                </div>
                <div class="form-group">
                    <label for="email">Email: <span class="required">*</span></label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="telefono">Tel칠fono:</label>
                    <input type="text" id="telefono">
                </div>
                <div class="form-group">
                    <label for="cod_pais">C칩digo Telef칩nico:</label>
                    <input type="text" id="cod_pais" value="+54">
                </div>
                <div class="form-group">
                    <label for="direccion">Direcci칩n:</label>
                    <input type="text" id="direccion">
                </div>
                <div class="form-group">
                    <label for="fecha_nacimiento">Fecha de Nacimiento:</label>
                    <input type="text" id="fecha_nacimiento" placeholder="DD/MM/AAAA">
                </div>
            </div>
        </div>
        <div class="form-actions-initial">
            <button type="button" id="btn-add-laboral" class="btn btn-secondary">A침adir datos laborales</button>
        </div>
    </div>

    <!-- SECCI칍N 2: DATOS LABORALES -->
    <div id="laboral-data" class="laboral-data">
        <div class="section">
            <h2 class="section-title">游눺 <span id="titulo-seccion-laboral">Datos Laborales</span></h2>
            <div class="area-puesto">
                <div class="form-group" style="flex-grow: 1;">
                    <label>츼rea: <span class="required">*</span></label>
                    <button type="button" id="btn-area" class="selector-btn">Selecciona un 치rea</button>
                </div>
                <div class="form-group" style="flex-grow: 1;">
                    <label>Puesto: <span class="required">*</span></label>
                    <button type="button" id="btn-puesto" class="selector-btn" disabled>Selecciona un puesto</button>
                </div>
            </div>
            <div class="permisos-info" id="permisos-info" style="display: none;">
                <h3>游 Permisos del Puesto</h3>
                <div id="permisos-display" class="permisos-display"></div>
            </div>
        </div>
        
        <!-- SECCI칍N 3: HORARIO -->
        <div class="section schedule-section">
            <h2 class="section-title">游 Horario Semanal Recurrente</h2>
            <div class="color-palette-container">
                <span>Mismo horario para:</span>
                <div id="color-palette" class="color-palette"></div>
                <button type="button" id="add-color" class="add-btn">
                    <img src="{% static 'iconos/add_circle.png' %}" alt="A침adir color">
                </button>
            </div>
            <div id="schedule-container"></div>
            <div class="daily-schedule-container" id="daily-schedule-container"></div>
        </div>
    </div>

    <!-- BOTONES FINALES -->
    <div class="main-form-actions">
        <button type="button" id="btn-cancel" class="btn btn-danger">
            <i class="fas fa-times"></i> Cancelar
        </button>
        <button type="button" class="btn btn-success" id="btn-listo">
            <i class="fas fa-check"></i> <span id="texto-btn-listo">Listo</span>
        </button>
    </div>
</div>

<!-- MODAL PARA SELECCIONAR 츼REA/PUESTO -->
<div id="modal-seleccionar" class="modal-overlay">
    <div class="modal-content">
        <h2 id="seleccionar-titulo"></h2>
        <input type="text" id="searchInput" placeholder="Buscar...">
        <ul id="resultsList"></ul>
        <div class="modal-actions">
            <button type="button" class="btn btn-light" id="btn-seleccionar-volver">Cerrar</button>
        </div>
    </div>
</div>

<!-- CARGAR SISTEMA DE AUDIO PRIMERO -->
<script src="{% static 'JS/audio-system.js' %}"></script>
<!-- LUEGO CARGAR EL SCRIPT PRINCIPAL -->
<script src="{% static 'JS/crear_empleado.js' %}"></script>
</body>
</html>